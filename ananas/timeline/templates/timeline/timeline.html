{% extends "header.html" %}
{% block title %}Timeline{% endblock %}
{% block content %}
    <h1>Bienvenue sur la timeline !</h1>

    <!--Ajouter un nouvel article-->
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <input type="submit" value="Submit">
    </form>
    <div> <!--Liste des posts-->
    {% for post in posts %}<!--TODO: Redimentionner les images-->
        <div class="post"> <!--TODO: content-markdown ==> DONE-->
            <h3>{{ post.titre }}</h3>
            <p>{{ post.contenu_post| safe |truncatewords_html:7 }}</p>
            <p><a href={{ post.id }}>Lire la suite</a></p>

            {% if post.photo %}
                <div class="photos">
                    <img src="/media/{{post.photo}}"/>
                </div>
            {% endif %}
        </div>


        <div>---------------------</div>
        <!--For comment in comments-->
        {% empty %}
        <p>Aucun article sur la timeline.</p>
    {% endfor %}
    </div>

{% endblock %}
{% block script%}
    <!--Markdown-->
    <script
            src="https://cdnjs.cloudflare.com/ajax/libs/marked/1.1.0/marked.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $(".content-markdown").each(function(){

                var article_content = $("this").text()
                console.log(article_content)
                var markedArticle = marked(article_content)
                console.log(markedArticle)
                $(this).html(markedArticle)
            })

        })
    </script>
{% endblock %}
</body>
</html>